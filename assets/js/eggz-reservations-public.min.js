!function(e){"use strict";e(function(){var a=parseInt(POST_SUBMITTER.date_picker_days),t=POST_SUBMITTER.open_hours;e("#datepicker").datetimepicker({useCurrent:!0,stepping:15,format:"MM/DD/YYYY",allowInputToggle:!0,minDate:moment({hour:10,minute:0,seconds:0}),maxDate:moment().add(a,"days").hour(24)}),e("#timepicker").datetimepicker({useCurrent:!1,stepping:15,format:"hh:mm a",allowInputToggle:!0}),e("#datepicker").on("dp.show",function(a){e("#timepicker").data("DateTimePicker").destroy(),e("#timepicker").datetimepicker({useCurrent:!1,stepping:15,allowInputToggle:!0,format:"hh:mm a"}),e("#timepicker").data("DateTimePicker").hide()}).on("dp.hide",function(a){e("#timepicker").data("DateTimePicker").show()}).on("dp.change",function(a){console.log(moment(a.date).day());var i=t[moment(a.date).day()].open,n=t[moment(a.date).day()].close;i=void 0==i?10:moment(i,["h:mm A"]).format("H"),n=void 0==n?22:moment(n,["h:mm A"]).format("H"),moment(a.date).date()==moment(new Date).date()?moment(new Date).hour()>=n?alert("We are goin' to close for today. Please make the reservation for another day."):(e("#timepicker").data("DateTimePicker").defaultDate(moment(a.date).format("hh:mm A")),e("#timepicker").data("DateTimePicker").date(moment(a.date)),e("#timepicker").data("DateTimePicker").minDate(moment(a.date)),e("#timepicker").data("DateTimePicker").maxDate(moment(a.date).hour(n).minute(0).second(0))):(e("#timepicker").data("DateTimePicker").date(moment(a.date).hour(i).minute(0).second(0)),e("#timepicker").data("DateTimePicker").maxDate(moment(a.date).hour(n).minute(0).second(0)),e("#timepicker").data("DateTimePicker").minDate(moment(a.date).hour(i).minute(0).second(0)))}),e(".reservations-form").on("click","#book-a-table-trigger",function(a){if(a.preventDefault(),e(".add-reservation-form").valid()){var t=e(".add-reservation-name").val(),i=e("#datepicker input").val(),n=e("#timepicker input").val(),o=e(".personspicker button").attr("title"),d=e(".add-reservation-special-requests").val();e.ajax({method:"POST",url:POST_SUBMITTER.ajax_url,type:"post",data:{action:"eggz_reservation_details",title:t,date:i,time:n,persons:o,special_requests:d,nonce:POST_SUBMITTER.nonce},success:function(a){e(".reservations-form").append(a),e(".add-reservation-form").remove()},fail:function(e){}})}else alert("Please fill all required items")}),e(".reservations-form").on("click","#add-a-reservation-trigger",function(a){if(a.preventDefault(),e(".eggz-reservations-details").valid()){var t=e(".send-reservation-date").val(),i=e(".send-reservation-time").val(),n=e(".send-reservation-persons").val(),o=e(".send-reservation-phone").val(),d=e(".send-reservation-full-name").val(),r=e(".send-reservation-email").val(),s=e(".send-reservation-special-request").val();e.ajax({method:"POST",url:POST_SUBMITTER.ajax_url,type:"post",data:{action:"eggz_add_reservation",title:d,name:d,date:t,time:i,persons:n,phone:o,email:r,request:s,nonce:POST_SUBMITTER.nonce},success:function(a){console.log(a),e(".reservations-form").append(a),e(".eggz-reservations-details").remove()},fail:function(e){console.log(e)}})}else alert("Please fill all required items")});var i=e(".reservation-content");e(".eggz-reservation-trigger").on("click",function(a){a.preventDefault(),e(".eggz-reservation-details").slideUp("fast"),e(".reservation-content").removeClass("open"),e(this).parents(".reservation-content").find(".eggz-reservation-details").slideToggle("fast"),e(this).parents(".reservation-content").addClass("open")}),e(window).on("click.Bst",function(a){return 0!=i.has(a.target).length||i.is(a.target)?!1:(e(".eggz-reservation-details").fadeOut("fast"),void e(".reservation-content").removeClass("open"))}),e(".selectpicker").selectpicker(),e(".reservations-filters li").on("click tap",function(a){a.preventDefault(),e(".reservation-box").hide(),e("."+e(this).data("type")).show(),e(this).data("type")}),e(".eggz-reservations").on("change","select",function(){var a=e(this).data("postid"),t=e(this).data("table"),i=e(this).find("option:selected").val();e.ajax({method:"POST",url:POST_SUBMITTER.ajax_url,data:{action:"eggz_set_reservation_table",id:a,table:i},success:function(n){e(".eggz-reservations-list").find('[data-postid="'+a+'"]').removeClass("unassigned").removeClass(t).addClass(i).data("table",i)}})}),e("#editReservationModal").on("show.bs.modal",function(a){var t=e(a.relatedTarget),i=e(this);i.find(".date").text(t.data("date")),i.find(".modal-body input#reservation-id").val(t.data("id")),i.find(".modal-body input#date").val(t.data("date")),i.find(".modal-body input#time").val(t.data("time")),i.find(".modal-body input#persons").val(t.data("persons")),i.find(".modal-body input#email").val(t.data("email")),i.find(".modal-body input#phone").val(t.data("phone")),i.find(".modal-body input#name").val(t.data("name")),i.find(".modal-body textarea#specialrequest").val(t.data("specialrequests")),i.find(".modal-body input#date").datetimepicker({useCurrent:!0,stepping:15,format:"MM/DD/YYYY",allowInputToggle:!0}),i.find(".modal-body input#time").datetimepicker({useCurrent:!1,stepping:15,format:"hh:mm a",allowInputToggle:!0}),i.find(".edit-reservation-modal-save").on("click tap",function(a){if(a.preventDefault(),i.find("form").valid()){i.find(".eggz-abs-loader").show(),i.find("form").css("opacity",".5");var t=i.find(".modal-body input#reservation-id").val(),n=i.find(".modal-body input#date").val(),o=i.find(".modal-body input#time").val(),d=i.find(".modal-body input#persons").val(),r=i.find(".modal-body input#email").val(),s=i.find(".modal-body input#phone").val(),l=i.find(".modal-body input#name").val(),m=i.find(".modal-body input#specialrequests").val();e.ajax({url:POST_SUBMITTER.ajax_url,method:"POST",data:{action:"eggz_update_reservation",id:t,date:n,time:o,persons:d,email:r,phone:s,name:l,request:m},success:function(a){i.find(".eggz-abs-loader").hide(),i.find("form").css("opacity","1"),console.log(a+" - ok");var t=i.find(".modal-body input#reservation-id").val();e('[data-postid="'+t+'"] .eggz-reservations-date').text(i.find(".modal-body input#date").val()),e('[data-postid="'+t+'"] .eggz-reservations-reservation-date.field-value').text(i.find(".modal-body input#date").val()),e('[data-postid="'+t+'"] .eggz-reservations-reservation-time.field-value').text(i.find(".modal-body input#time").val()),e('[data-postid="'+t+'"] .eggz-reservations-reservation-persons.field-value').text(i.find(".modal-body input#persons").val()),e('[data-postid="'+t+'"] .eggz-reservations-reservation-email.field-value').text(i.find(".modal-body input#email").val()),e('[data-postid="'+t+'"] .eggz-reservations-reservation-phone.field-value').text(i.find(".modal-body input#phone").val()),e('[data-postid="'+t+'"] .eggz-reservations-reservation-name.field-value').text(i.find(".modal-body input#name").val()),e('[data-postid="'+t+'"] .eggz-reservations-reservation-specialrequest.field-value').text(i.find(".modal-body input#specialrequest").val())},fail:function(e){i.find(".eggz-abs-loader").hide(),i.find("form").css("opacity","1"),console.log(e)}})}})});var n=!1;e("#deleteReservationModal").on("show.bs.modal",function(a){var t=e(a.relatedTarget),i=e(this);i.find(".reservation-id").val(t.data("id")),i.find(".delete-all-reservations").val(t.data("delete-all")),t.data("delete-all")?(n=!0,i.find("p").hide(),i.find("p.delete-all-reservations-message").show()):(i.find("p").hide(),i.find("p.delete-single-reservation-message").show())}).on("click tap",".yes",function(a){a.preventDefault(),console.log(n);var t=e(this).parent().find(".reservation-id").val();e.ajax({url:POST_SUBMITTER.ajax_url,method:"POST",data:{action:"eggz_delete_reservation",deleteall:n,id:t},success:function(a){console.log(a),n?e(".eggz-reservations-list").empty():e(".eggz-reservations-list").find('[data-postid="'+t+'"]').remove(),e("#deleteReservationModal").modal("hide")},fail:function(e){console.log(e)}})})})}(jQuery);
